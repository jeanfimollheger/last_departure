{% extends "base.html" %}

{% block title %}{{ project.name }}{% endblock %}

{% block content %}
<h1>{{ project.name }}</h1>

<p>
    {% if project.deadline %}
        <strong>Deadline:</strong> {{ project.deadline }}
    {% endif %}
</p>

<p>
    <strong>Private:</strong>
    {{ project.private|yesno:"Yes,No" }}
</p>

<hr>
    <div class="mt-3">
        <a href="{% url 'project_update' project.slug %}" class="btn btn-outline-primary">
            Edit
        </a>

        <a href="{% url 'project_delete' project.slug %}" class="btn btn-outline-danger">
            Delete
        </a>
    </div>
<hr>

<h2>Tasks</h2>

{% if project.tasks.exists %}
    <ul class="list-group mb-3">
        {% for task in project.tasks.all %}
            <li class="list-group-item d-flex justify-content-between align-items-center">

                {{ task.description }} // {{ task.deadline|default:"(no deadline)"}} // {{ task.time|default:"(no estimate)" }} H

                <div class="btn-group">
                    {% if user == project.creator or user == task.creator %}
                        <a href="{% url 'task_update' task.slug %}"
                           class="btn btn-sm btn-outline-primary">
                            Edit
                        </a>
                    {% endif %}

                    <form method="post" action="{% url 'task_done' task.slug %}">
                        {% csrf_token %}
                        {% if not task.done %}
                            <button class="btn btn-sm btn-primary">
                                Mark as done
                            </button>
                        {% else %}
                            <button class="btn btn-sm btn-secondary" disabled>
                                Already done
                            </button>
                        {% endif %}
                    </form>
                </div>

            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No tasks yet.</p>
{% endif %}

<a href="{% url 'task_create' project.slug %}"
   class="btn btn-primary mb-4">
    Create task
</a>
<hr>
<hr>

<a href="{% url 'project_list' %}"
   class="btn btn-secondary">
    Back to projects
</a>

{% endblock %}
